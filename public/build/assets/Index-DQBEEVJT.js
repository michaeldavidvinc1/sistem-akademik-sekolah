import{r as m,u as A,y as p,j as e}from"./app-pLi7Pmpp.js";import{D as F,G as R,C as _,U as V}from"./Layout-BrjJb0vu.js";import{B as W}from"./button-8U27WDK7.js";import{C as b,a as N}from"./card-CovMvrux.js";import{I as Y}from"./input-CJuEtsCP.js";import{S as C,a as D,b as T,c as I,d as J,e as x}from"./select-9FnE8WmF.js";import{T as z,a as K,b as g,c as l,d as L,e as r}from"./table-BmBEuTDW.js";import{T as O}from"./textarea-BmUE-b4i.js";import{C as Q}from"./clock-DWtPFX5g.js";import{c as X}from"./createLucideIcon-CFEph-0y.js";import"./sheet-C6uFUOJF.js";import"./index-Dsq69_sy.js";import"./index-DmrbsMZK.js";import"./dropdown-menu-CzrkE76-.js";import"./index-BpXMol_Z.js";/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=X("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),he=({auth:u,sudahAbsen:f,absensi:$,queryParams:n=null,kelas:o,siswa:h})=>{n=n||{};const[j,v]=m.useState([]),[S,B]=m.useState(!0),{toast:H}=A(),k=()=>{const a=new Date,s=a.getFullYear(),t=String(a.getMonth()+1).padStart(2,"0"),c=String(a.getDate()).padStart(2,"0");return`${s}-${t}-${c}`},[i,E]=m.useState({kelas_id:n.kelas_id||o.data[0].id.toString(),tanggal:n.tanggal||k()});m.useEffect(()=>{if(S&&o.data.length>0&&!(n!=null&&n.kelas_id)){const a=new URL(window.location.href),s=o.data[0].id.toString(),t=k();(!a.searchParams.get("kelas_id")||!a.searchParams.get("tanggal"))&&p.get(route("guru.absensi.form"),{kelas_id:s,tanggal:t},{preserveState:!0,preserveScroll:!0,replace:!0}),B(!1)}},[o.data,S]),m.useEffect(()=>{if(h.data){const a=h.data.map(s=>({siswa_id:s.id,status_kehadiran:"",keterangan:"",kelas_id:i.kelas_id,tanggal:i.tanggal,guru_id:u.user.id}));v(a)}},[h.data]);const y=(a,s)=>{E(t=>({...t,[a]:s})),p.get(route("guru.absensi.form"),{...i,[a]:s},{preserveState:!0,preserveScroll:!0,replace:!0})},w=(a,s,t)=>{v(c=>{const d=[...c];return d[a][s]=t,d})},G=a=>{a.preventDefault(),p.post(route("guru.absensi.store"),{attendance:j},{onSuccess:()=>{H({variant:"success",title:"Success!",description:"Submit absensi successfully!"})}})},M=()=>{const a=new Date,s=a.getHours().toString().padStart(2,"0"),t=a.getMinutes().toString().padStart(2,"0");return`${s}:${t}`},U=a=>{const s=new Date(a),t={day:"2-digit",month:"long",year:"numeric"};return s.toLocaleDateString("id-ID",t)};return e.jsx(F,{auth:u,children:e.jsxs("div",{className:"px-4 sm:px-6 lg:px-8 py-8",children:[e.jsx(b,{className:"mb-6 max-w-7xl mx-auto",children:e.jsxs(N,{className:"pt-6",children:[e.jsx("div",{className:"mb-6 pb-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-full",children:e.jsx(R,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:u.user.name}),e.jsx("p",{className:"text-sm text-gray-500",children:"Guru Pengajar"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 flex items-center gap-3",children:[e.jsx("div",{className:"bg-green-100 p-2 rounded-full",children:e.jsx(Q,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Waktu"}),e.jsxs("p",{className:"font-medium",children:[M()," WIB"]})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 flex items-center gap-3",children:[e.jsx("div",{className:"bg-purple-100 p-2 rounded-full",children:e.jsx(_,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Tanggal"}),e.jsx("p",{className:"font-medium",children:U(i.tanggal)})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3 flex items-center gap-3",children:[e.jsx("div",{className:"bg-orange-100 p-2 rounded-full",children:e.jsx(Z,{className:"h-5 w-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Status"}),e.jsx("p",{className:"font-medium",children:f?"Sudah Submit":"Belum Submit"})]})]})]}),e.jsx("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:e.jsxs("div",{className:"flex items-center gap-4 w-full md:w-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-full",children:e.jsx(_,{className:"h-5 w-5 text-blue-600"})}),e.jsx(Y,{type:"date",className:"w-full md:w-[200px]",value:i.tanggal,onChange:a=>y("tanggal",a.target.value)})]}),e.jsxs("div",{className:"flex items-center gap-2 w-full md:w-auto",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-full",children:e.jsx(V,{className:"h-5 w-5 text-blue-600"})}),e.jsxs(C,{name:"kelas_id",value:i.kelas_id,onValueChange:a=>y("kelas_id",a),children:[e.jsx(D,{className:"w-full md:w-[200px]",children:e.jsx(T,{placeholder:"Pilih Kelas"})}),e.jsx(I,{children:e.jsx(J,{children:o.data.map(a=>e.jsx(x,{value:a.id.toString(),children:a.nama_kelas},a.id))})})]})]})]})})]})}),f?e.jsx(b,{children:e.jsx(N,{className:"p-0",children:e.jsxs(z,{children:[e.jsx(K,{children:e.jsxs(g,{className:"bg-gray-50 hover:bg-gray-50",children:[e.jsx(l,{className:"w-16 text-center",children:"No"}),e.jsx(l,{className:"font-semibold",children:"Nama Lengkap"}),e.jsx(l,{className:"font-semibold",children:"Kelas"}),e.jsx(l,{className:"font-semibold",children:"Status"}),e.jsx(l,{className:"font-semibold",children:"Keterangan"})]})}),e.jsx(L,{children:$.data.map((a,s)=>e.jsxs(g,{className:"hover:bg-gray-50/50",children:[e.jsx(r,{className:"text-center font-medium text-gray-600",children:s+1}),e.jsx(r,{className:"font-medium",children:a.siswa.nama_lengkap}),e.jsx(r,{className:"text-gray-600",children:a.kelas.nama_kelas}),e.jsx(r,{children:e.jsx("div",{className:`inline-flex items-center px-3 py-1 rounded-full text-sm
                                        ${a.status_kehadiran==="hadir"?"bg-green-100 text-green-600":a.status_kehadiran==="sakit"?"bg-yellow-100 text-yellow-600":a.status_kehadiran==="izin"?"bg-blue-100 text-blue-600":"bg-red-100 text-red-600"}`,children:a.status_kehadiran==="hadir"?"✓ Hadir":a.status_kehadiran==="sakit"?"🤒 Sakit":a.status_kehadiran==="izin"?"ℹ️ Izin":"✗ Alpha"})}),e.jsx(r,{children:e.jsx("p",{className:"text-gray-600",children:a.keterangan||"-"})})]},s))})]})})}):e.jsx(b,{children:e.jsx(N,{className:"p-0",children:e.jsxs("form",{onSubmit:G,children:[e.jsxs(z,{children:[e.jsx(K,{children:e.jsxs(g,{className:"bg-gray-50 hover:bg-gray-50",children:[e.jsx(l,{className:"w-16 text-center",children:"No"}),e.jsx(l,{className:"font-semibold",children:"Nama Lengkap"}),e.jsx(l,{className:"font-semibold",children:"Kelas"}),e.jsx(l,{className:"font-semibold",children:"Status"}),e.jsx(l,{className:"font-semibold",children:"Keterangan"})]})}),e.jsx(L,{children:h.data.map((a,s)=>{var t,c;return e.jsxs(g,{className:"hover:bg-gray-50/50",children:[e.jsx(r,{className:"text-center font-medium text-gray-600",children:s+1}),e.jsx(r,{className:"font-medium",children:a.nama_lengkap}),e.jsx(r,{className:"text-gray-600",children:a.kelas.nama_kelas}),e.jsx(r,{children:e.jsxs(C,{value:(t=j[s])==null?void 0:t.status_kehadiran,onValueChange:d=>w(s,"status_kehadiran",d),children:[e.jsx(D,{className:"w-[180px]",children:e.jsx(T,{placeholder:"Pilih Status"})}),e.jsxs(I,{children:[e.jsx(x,{value:"hadir",className:"text-green-600",children:"✓ Hadir"}),e.jsx(x,{value:"sakit",className:"text-yellow-600",children:"🤒 Sakit"}),e.jsx(x,{value:"izin",className:"text-blue-600",children:"ℹ️ Izin"}),e.jsx(x,{value:"alpha",className:"text-red-600",children:"✗ Alpha"})]})]})}),e.jsx(r,{children:e.jsx(O,{placeholder:"Tambahkan keterangan...",value:(c=j[s])==null?void 0:c.keterangan,onChange:d=>w(s,"keterangan",d.target.value),className:"min-h-[80px] resize-none"})})]},s)})})]}),e.jsx("div",{className:"p-4 border-t bg-gray-50/50",children:e.jsx("div",{className:"flex justify-end",children:e.jsx(W,{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white px-6",children:"Submit Absensi"})})})]})})})]})})};export{he as default};
